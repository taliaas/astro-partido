---
import RootLayout from "@/layouts/RootLayout.astro";
import { getSession } from "auth-astro/server";
import UserService from "@/services/UserService";
import Perfil from "@/components/Profile/Perfil.vue";

const session = await getSession(Astro.request);
const n_user = session?.user;

async function getUser() {
  const services = new UserService();
  try {
    return await services.verify((session as any).jwt);
  } catch (e) {
    console.error(e);
  }
}

const user = await getUser();
---

<RootLayout>
  <Perfil user={user} client:load />
</RootLayout>
